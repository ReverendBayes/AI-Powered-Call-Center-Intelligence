# --- call_summary.db creator ---
# One-time script to create the DuckDB database and `calls` table schema
# You only need to run this once during setup.
# This file assumes you already have the `data/` directory created.

import duckdb
from pathlib import Path

# --- Set up database path and ensure folder exists ---
data_dir = Path("data")
data_dir.mkdir(exist_ok=True)
db_path = data_dir / "call_summary.db"

# --- Connect to the DuckDB file (creates if doesn't exist) ---
con = duckdb.connect(str(db_path))

# --- Create the main table schema ---
# All processed call results (transcript, redacted, GPT insights) get inserted here
con.execute("""
CREATE TABLE IF NOT EXISTS calls (
    call_id VARCHAR,
    transcript TEXT,
    redacted_transcript TEXT,
    insights JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
""")

print(f"âœ… call_summary.db and 'calls' table created at {db_path}")